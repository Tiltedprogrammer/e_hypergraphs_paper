\documentclass[acmsmall,screen, nonacm, review, anonymous]{acmart}


\usepackage{amsmath,amsfonts}
\usepackage{algorithmic}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor,soul}

\usepackage{amsthm}
\usepackage{hyperref}
\usepackage{stmaryrd}

\usepackage{mathtools}
\usepackage{tikz}
\usepackage{tikz-network}
\usepackage{xspace}
\usepackage{xargs}
\usepackage{fontenc}
\usepackage{csquotes}

\usepackage{subcaption}
\usepackage{caption}

\usepackage{tikz-cd}
\usepackage{tikzit}
% to reduce tikz picture white space
\usepackage{adjustbox}

% for quotienting
\usepackage{xfrac} 
\usepackage{wrapfig}

\usepackage{microtype}

% inference rules
\usepackage{mathpartir}

% space saving
\usepackage[moderate,bibbreaks=normal,bibnotes=normal,bibliography=normal,leading=normal]{savetrees}

\newcommand{\ONECOLUMN}{}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{lemma}[theorem]{Lemma}

% change red to orange
\definecolor{e-color}{named}{orange}
\definecolor{closed-color}{named}{blue}


% some macros that maybe should be moved elsewhere

\newcommand\HypI[1]{\textbf{HypI}(#1)}
\newcommand\MdaCospans{\textbf{MHypI}(\Sigma)}
\newcommand{\Ecospans}{{\catname{CEHypI(\Sigma)}}}
\newcommand{\MdaEcospans}{{\catname{MCEHypI(\Sigma)}}}
\newcommand{\WellTypedMdaEcospans}{{\catname{MCEHypI(\Sigma)}}}
% conflict
\newcommand{\hashtag}{{\#}}
\newcommand{\consistency}{{\smile}}

\input{../../macros}
\input{../../sample.tikzstyles}
\input{../../hypergraph.tikzstyles}
\input{../../hypergraph.tikzdefs}


\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}


\title{Categorical Foundations of E-Graphs With Binding}


\begin{document}

\begin{abstract}
	Equality saturation, a technique for program optimisation and reasoning, has gained attention due to the resurgence of equality graphs (e-graphs).
	E-graphs represent equivalence classes of terms under rewrite rules, enabling simultaneous rewriting across a family of terms.
	However, they struggle in domains like $\lambda$-calculus that involve variable binding, due to a lack of native support for bindings.
	Building on recent work interpreting e-graphs categorically as morphisms in symmetric monoidal semilattice-enriched categories, we extend this framework to closed symmetric monoidal semilattice-enriched categories to handle bindings.
	We provide a concrete combinatorial representation using an extension of hierarchical hypergraphs and introduce a corresponding double-pushout (DPO) rewriting mechanism.
	Finally, we establish the equivalence of term rewriting and DPO rewriting, with the key property that the combinatorial representation absorbs the equations of the symmetric monoidal structure.
\end{abstract}

\maketitle

\input{sections/introduction}
\input{sections/categorical_semantics}
\input{sections/combinatorial_semantics}
\input{sections/soundness}
\input{sections/lambda-calculus}

\section{Conclusion}
In this work we introduced e-graphs with bindings formalised as morphisms of a closed symmetric monoidal $\catname{SLat}$-category.
In doing so, we are able to leverage its internal language to provide variable binding in $\lambda$-calculus-like languages by metatheoretic $\lambda$-abstraction.
We then provided a combinatorial representation for such morphisms in terms of closed e-hypergraphs with a suitable notion of sound and complete DPO rewriting, making it possible for a closed e-hypergraph to represent equivalences derivable from a set of equations $\mathcal{E}$.
We argued for the utility of our techniques in the representation of programming languages (which inherently require variable binding) as e-graphs, contrasting with the more general-purpose slotted e-graphs, and advocating for the benefits of string-diagrammatic syntax.
In future, we hope to implement an efficient version of e-graphs for hypergraphs as a data structure using DPO rewriting as its foundation to implement e-graph operations, with the theory we have developed here acting as a roadmap.

\bibliographystyle{ACM-Reference-Format}
\bibliography{../../bibliography}

\appendix

\input{sections/appendix}

\end{document}
